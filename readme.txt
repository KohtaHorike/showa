read me 開発ログ


参考資料
町田氏の資料(PDODB接続)
dotinstall php でのアプリケーション構築/セキュリティ面に関してもベース

開発環境　
Device Machine: Mac yosemite 
Editor: Sublime Text 3 w/ snippet control package 
language code: Japanses
charset: UTF-8 
Local Sever Envuronment: MAMP 
PHP version: 5.6.10
Database:MySQL
Rental sever: さくらサーバー

開発バージョン
1.0 ローカル開発
2.0 オンライン開発／バグ修正
3.0 機能強化
	3.1.x php/SQL　パート
	3.2.x html/css/javascript パート	

構成
*ログイン画面
**ログイン画面
**ログイン要求画面

*ユーザー画面
**ログイン後ユーザー画面
**記事閲覧画面

*登録画面
**ユーザー登録入力画面
**入力データ確認画面

::log::

:31/JUL/2015
ローカルベースので開発は終了
レンタルサーバーへの移植を目指すが失敗

エラー事項
*文字化け(MySQL/PHPともに)
*SQL接続失敗
*強制リダイレクト

当日中の回復を目指すが失敗

エラー対策
*MySQL接続
当然のことながら接続方法がローカルでの接続とは異なるので、
最初の接続が失敗
=>原因としてはホスト名の設定忘れ
ホスト名を設定しなおして接続
接続は確保される

*DB問題
1.0ターミナルからのDB設定を試みる。
sshでの接続が可能であったので、フィールド設定などはターミナルから
行う。
ssh接続参考サイト
[さくらインターネットのデータベースにmacのターミナルからssh接続してみた]
http://d.hatena.ne.jp/hop_head/20130913/1379071336
問題なくクリア
ただし、大量のデータをC＆Pで行うと強制的に接続切断が行われる。
今回はphpMyadminからの登録でことなきを得たが問題の検証が必要である。
=>実際には、記事データなどの大量の文字データは別にすべきであるDBに格納すべきでなさそう


2.0phpからのMySQLの接続が確保されたが、レンタルしているサーバー（さくら）での
MySQLのエンコード設定がEUC-JPがデフォルトその他SHIJなどの設定があり
データが全て文字化け。
MySQLの
"  SHOW VARIABLES LIKE 'char%'  "
での設定で全て=>utf8に変更で
MySQL上での文字化けは解消
2.1 問題プロトコル1にて解決したpdo接続問題と併せて問題解決し、
接続しデータをphp上に吐き出したところ、再び文字化けの問題が起きる。
これは、さくらサーバーのMySQL言語設定がEUCであることからの起因であり、
解決方法が見つからずスタック。


:01/AUG/2015
=>2.1 昨日に引き続きDBからのデータ文字化けの解決に当たる。
「さくら　mysql 接続　文字化け」などで検索をかけるとたくさんヒットするが、
phpバージョンが5.3以前でのヒットが多く。
基本的に問題解決方法を、推奨されている「PDO()（関数）」ではなく、
「mysqli()（関数）」での引数に文字コードをutf8を指定するという解決方法であった。
mysqliでの接続はセキュア的な問題から？マークであったので、PDOでの接続方法を探す。
最終的にホスト接続時にPDOの場合は、文字コードを設定できることが判明し、
文字コード問題が解決する。

:02/AUG/2015
昨日は環境構築が完了したのでひと段落を行ったが、環境構築に手を取られていたので、
コンテンツの充実などを計るように持って行く。

3.0コンテンツ・設計改善		
現状の顕在化している問題の解決
php/sql
*DB登録時の登録成功のページを表示させる =>完了
3.1.1=>thanks.phpを作成
javascript dcoument.location="URL"で
setTimeoutを利用し5秒後のリダイレクトを行う。

*フォーム送信時のCSRF対策　hidden inputの設置
3.1.2=>CSRF対策を行う
SHA1の対策方法以外の対策方法を構築予定
open_ssl_pseudo_bytes(num);を使用
debug.phpにてテストチェック=>問題なくトークンを作成
login.phpに移植完了

*登録時のpassword_hash関数の使用と、ユーザー認証時のpassword_verify()の使用
*データベースコンテンツ部分の別データファイル化とデータインポートシステムの構築

*記事管理画面の作成とarticle_tblへの削除フラグの追加

*国別記事ソートのためにtag国タグの追加

*aritcle.phpにおけるid不正でのアクセス不正を表示する

*ユーザー登録重複回避
checkEmail関数を作成
dotInstall参考にデータを取得できた場合false
HTML/CSS/jacascript/jQuery

*フォームにjavascriptでの確認パスワードチェック


:05/AUG/2015
